const addForm=document.querySelector("#form-add");const addFormName=addForm.querySelectorAll("input.form-control")[0];const addFormUrl=addForm.querySelectorAll("input.form-control")[1];const visitBtn=document.querySelector("button#visit-button");const addBtn=document.querySelector("button#add-button");const delBtn=document.querySelector("button.btn-danger");const clearBtn=document.querySelector("button.btn-dark");const filterForm=document.getElementById("form-search");const bookmarksTable=document.querySelector("tbody.bookmarks");loadEventListeners();function loadEventListeners(){document.addEventListener('DOMContentLoaded',getBookmarks);addForm.addEventListener('submit',addBookmark);bookmarksTable.addEventListener('click',visitBookmark);bookmarksTable.addEventListener('click',selectBookmarks);bookmarksTable.addEventListener('click',removeBookmark);delBtn.addEventListener('click',removeBookmarks);visitBtn.addEventListener('click',visitSelectedBookmark);clearBtn.addEventListener('click',clearBookmarks);filterForm.addEventListener('keyup',filterBookmarks)}
function addBookmark(e){if(addFormName.value===""||addFormUrl.value===""){return alert("Fill out the fields properly !")}
let counter=(bookmarksTable.querySelectorAll("tr").length+1);const inputTableElement=document.createElement("div");inputTableElement.className="form-control bookmark-output";inputTableElement.innerText=addFormName.value;let childElement=document.createElement("small");childElement.className="text-muted d-inline-block float-right mt-2 mr-2";inputTableElement.appendChild(childElement);const tableElement=document.createElement("tr");tableElement.innerHTML=`
        <th scope="row" class="bookmark-number">${counter}</th>
        <td>
            <div class="input-group">
                <div class="input-group-prepend px-3 bg-dark form-check">
                    <input class="form-check-input position-static mx-0 my-auto py-auto blankCheckbox" type="checkbox">
                </div>
                ${inputTableElement.outerHTML}
                <div class="input-group-append">
                    <button type="button" class="btn bg-success text-white font-weight-lighter main-visit-btn">Visit<i class="fas fa-eye ml-2"></i></button>
                    <button type="button" class="btn btn-secondary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <span class="sr-only">Toggle Dropdown</span>
                    </button>
                    <div class="dropdown-menu">
                        <a class="dropdown-item" id="dropdown-visit" href="#">Visit</a>
                        <a class="dropdown-item" id="dropdown-edit" href="#">Edit</a>
                    <div role="separator" class="dropdown-divider"></div>
                    <a class="dropdown-item" id="dropdown-remove" href="#">Remove<i class="fas fa-times float-right my-auto" style="color: red"></i></a>
                    </div>
                </div>
            </div>
        </td>
        `
bookmarksTable.appendChild(tableElement);storeToLocalStorage(addFormName.value,addFormUrl.value)
function storeToLocalStorage(bookName,bookUrl){let bookmarksList;if(localStorage.getItem("bookmarksList")===null){bookmarksList=[]}else{bookmarksList=JSON.parse(localStorage.getItem("bookmarksList"))}
bookmarksList.push(`name: ${bookName}, url: ${bookUrl}`);localStorage.setItem("bookmarksList",JSON.stringify(bookmarksList))}
addFormName.value="";addFormUrl.value="";e.preventDefault()}
function getBookmarks(e){let bookmarksList;if(localStorage.getItem("bookmarksList")===null){return bookmarksList=[]}else{bookmarksList=JSON.parse(localStorage.getItem("bookmarksList"))}
let counter=1;for(let i=0;i<bookmarksList.length;i++){const arrayUnsplit=bookmarksList[i].split(", ");const arraySplit=arrayUnsplit[0].split(": ")[1];const displayArraySplit=arrayUnsplit[1].split(": ")[1];const inputTableElement=document.createElement("div");inputTableElement.className="form-control bookmark-output";inputTableElement.innerText=arraySplit;let childElement=document.createElement("small");childElement.className="text-muted d-inline-block float-right mt-2 mr-2";childElement.innerText=displayArraySplit;inputTableElement.appendChild(childElement);const tableElement=document.createElement("tr");tableElement.innerHTML=`
            <th scope="row" class="bookmark-number">${counter++}</th>
            <td>
                <div class="input-group">
                    <div class="input-group-prepend px-3 bg-dark form-check">
                    <input class="form-check-input position-static mx-0 my-auto py-auto blankCheckbox" type="checkbox">
                    </div>
                    ${inputTableElement.outerHTML}
                    <div class="input-group-append">
                        <button type="button" class="btn bg-success text-white font-weight-lighter main-visit-btn">Visit<i class="fas fa-eye ml-2"></i></button>
                        <button type="button" class="btn btn-secondary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <span class="sr-only">Toggle Dropdown</span>
                        </button>
                        <div class="dropdown-menu">
                            <a class="dropdown-item" id="dropdown-visit" href="#">Visit</a>
                            <a class="dropdown-item" id="dropdown-edit" href="#">Edit</a>
                        <div role="separator" class="dropdown-divider"></div>
                        <a class="dropdown-item" id="dropdown-remove" href="#">Remove<i class="fas fa-times float-right my-auto" style="color: red"></i></a>
                        </div>
                    </div>
                </div>
            </td>
            `
bookmarksTable.appendChild(tableElement)}
localStorage.setItem("bookmarksList",JSON.stringify(bookmarksList));e.preventDefault()}
function visitBookmark(e){if(e.target.classList.contains("main-visit-btn")===!0){let bookmarksList=JSON.parse(localStorage.getItem("bookmarksList"));let counter=e.target.parentElement.parentElement.parentElement.parentElement.firstElementChild.innerText;let arrayUnsplit=bookmarksList[counter-1].split(", ")
let arraySplit=arrayUnsplit[1].split(": ")
window.open(`${arraySplit[1]}`)}
else if(e.target.classList.contains("fa-eye")===!0){let bookmarksList=JSON.parse(localStorage.getItem("bookmarksList"));let counter=e.target.parentElement.parentElement.parentElement.parentElement.parentElement.firstElementChild.innerText;let arrayUnsplit=bookmarksList[counter-1].split(", ")
let arraySplit=arrayUnsplit[1].split(": ")
window.open(`${arraySplit[1]}`)}
else if(e.target.id==="dropdown-visit"){let bookmarksList=JSON.parse(localStorage.getItem("bookmarksList"));let counter=e.target.parentElement.parentElement.parentElement.parentElement.parentElement.firstElementChild.innerText;let arrayUnsplit=bookmarksList[counter-1].split(", ")
let arraySplit=arrayUnsplit[1].split(": ")
window.open(`${arraySplit[1]}`)}}
function visitSelectedBookmark(e){let counter=0;let bookmarksList=JSON.parse(localStorage.getItem("bookmarksList"));let nodeList=document.querySelectorAll(".blankCheckbox");nodeList.forEach(function(selectedBookmark){if(selectedBookmark.checked===!1){console.log("not listed");counter=counter+1}
if(selectedBookmark.checked===!0){let arrayUnsplit=bookmarksList[counter].split(", ")[1];arraySplit=arrayUnsplit.split(": ")[1];window.open(`${arraySplit}`);counter=counter+1}})
localStorage.setItem("bookmarksList",JSON.stringify(bookmarksList));e.preventDefault()}
function selectBookmarks(e){if(e.target.classList.contains("blankCheckbox")===!0){if(e.target.outerHTML==='<input class="form-check-input position-static mx-0 my-auto py-auto blankCheckbox" type="checkbox">'){e.target.outerHTML='<input class="form-check-input position-static mx-0 my-auto py-auto blankCheckbox" type="checkbox" checked>'}else{e.target.outerHTML='<input class="form-check-input position-static mx-0 my-auto py-auto blankCheckbox" type="checkbox">'}}
e.preventDefault()}
function removeBookmark(e){if(e.target.id==="dropdown-remove"){let bookmarksList=JSON.parse(localStorage.getItem("bookmarksList"));let counter=e.target.parentElement.parentElement.parentElement.parentElement.parentElement.firstElementChild.innerText;e.target.parentElement.parentElement.parentElement.parentElement.parentElement.remove();bookmarksList.splice(counter-1,1);localStorage.setItem("bookmarksList",JSON.stringify(bookmarksList))}
e.preventDefault()}
function removeBookmarks(e){let counter=0;let bookmarksList=JSON.parse(localStorage.getItem("bookmarksList"));let nodeList=document.querySelectorAll(".blankCheckbox");nodeList.forEach(function(selectedBookmark){if(selectedBookmark.checked===!1){document.getElementsByTagName("tr")[counter+1].children[0].innerText=counter+1
counter=counter+1}
if(selectedBookmark.checked===!0){selectedBookmark.parentElement.parentElement.parentElement.parentElement.remove();bookmarksList.splice(counter,1)}})
localStorage.setItem("bookmarksList",JSON.stringify(bookmarksList));e.preventDefault()}
function clearBookmarks(e){while(bookmarksTable.childElementCount!==0){bookmarksTable.childNodes[1].remove()}
localStorage.clear("bookmarksList");e.preventDefault()}
function filterBookmarks(e){let text=e.target.value.toLowerCase();bookmarksTable.querySelectorAll(".bookmark-output").forEach(function(item){let eq=item.innerText;if(eq.toLowerCase().includes(text)){item.parentElement.parentElement.parentElement.className=""}else{item.parentElement.parentElement.parentElement.className="d-none"}})
e.preventDefault()}